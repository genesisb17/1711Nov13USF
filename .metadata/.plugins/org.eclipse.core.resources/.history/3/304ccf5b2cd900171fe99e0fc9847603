package com.rev.service;

import java.util.ArrayList;

import com.rev.dao.DAO;
import com.rev.dao.FileDao;
import com.rev.pojo.Account;
import com.rev.pojo.newUser;

public class Service {

	static DAO dao = new FileDao();

	public newUser validateUser(String email){
		newUser user = dao.getUser(email);
		if(user.getId()==0) return null;
		return user;
	}

	public newUser login(int id, String pass){
		newUser u = dao.getUserById(id);
		if(u.getPassword().equalsIgnoreCase(pass)){
			return u;
		}
		else return null;
	}

	public newUser addUser(newUser u){
		int id = dao.addUser(u.getFirstname(), u.getLastname(), u.getEmail(), u.getPassword());
		u.setId(id);
		return u;
	}

	public Account addAccount(newUser u, String type){
		int id;
		if(type.equalsIgnoreCase("checking")){
			id = 1;
		}
		else if(type.equalsIgnoreCase("savings")){
			id = 2;
		}
		else if(type.equalsIgnoreCase("credit")){
			id = 3;
		}
		else{
			return null;
		}

		return dao.createAccount(u, id);
	}

	public ArrayList<Account> getUserAccounts(newUser u){
		return dao.getAccountsByUser(u);
	}


	public double withdraw(Account acc, double amt){
		double bal = dao.getBalance(acc.getA_id());
		if(amt>bal){
			//amount is too high
			return -1;
		}
		else{
			bal = bal-amt;
			dao.updateBalance(acc.getA_id(), bal);
		}

		return bal;
	}
}