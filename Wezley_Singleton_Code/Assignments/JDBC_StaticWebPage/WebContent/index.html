<!DOCTYPE html>
<html>
<head>

	<meta charset="ISO-8859-1">
	<title>Overview of JDBC - Essential Steps</title>
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
	integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
	crossorigin="anonymous">

	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
	integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
	crossorigin="anonymous"></script>
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"
	integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
	crossorigin="anonymous"></script>
	
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
	integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
	crossorigin="anonymous"></script>
	
	<style>
		body {
			margin-top: 25px;
			margin-right: 250px;
			margin-bottom: 25px;
			margin-left: 250px;
			background-color: grey;
		}
		
		.code {
			font-family: Courier;
			font-weight: 200;
			margin-left: 100px;
			margin-right: 100px;
			border: 1px solid grey;
			border-radius: 5px;
			padding: 10px 10px 10px 10px;
			background: #e9ebed;
		}
		
		.wrapper {
			background-color: white;
			padding: 25px;
		}
		
		.page-head {
			float: center;
		}
		
		p {
			text-align: justify;
		}
	</style>
	
</head>

<!-------------------------------------------------BODY------------------------------------------------->

<body>
	<div class="wrapper">
		<div class="page-head">
			<h1>Overview of JDBC - Essential Steps</h1>
			<p> By <a href="https://www.linkedin.com/in/wsingleton7861/">Wezley Singleton</a></p><hr>
		</div>
		
		<br><br>
		
		<h3>What is JDBC? Why is it important?</h3>
		<p><em>JDBC</em> is an acronym that stands for Java DataBase Connectivity, and 
		it is an <em>API</em>, or Application Programming Interface, specification that allows 
		Java developers to connect their applications to an external database.</p> 
		
		<p>The JDBC API allows Java developers the ability to create <em>SQL</em> (Structured Query 
		Language) statements which are passed to the <em>RDBMS</em>, or Relational DataBase 
		Management System. The results of valid SQL statements passed to the RDBMS are handed back to the
		interfaces within the JDBC, that allow the developer access to the result set or RDBMS output.</p>
		
		<p>JDBC is a powerful tool for Java developers, and lays the foundation for other technology frameworks such as
		Hibernate ORM (often referred to simply as, Hibernate). Hibernate abstract the mechanisms for sending SQL 
		statements to the database and add an implementation layer for interacting with the JDBC - which makes it easier 
		for developers to interact with their databases. The topic of Hibernate is out of the scope of this article, but 
		it is important to understand the role that JDBC plays in supporting the technologies build upon it.</p> <br>
		
		<hr>
		
		<div class="row">
			<div class="col-7">
				<h3>Using the JDBC in 7 Simple Steps</h3>
		
				<p>In this section, I will list and detail the eight basic steps that are followed in order to connect 
				a Java application to a database, send a query, and recieve back a result set that will be used in the 
				application.<p>
				
				<ol>
					<li>Import JDBC packages</li>
					<li>Load and register the appropriate JDBC driver</li>
					<li>Establish a connection to the database</li>
					<li>Creating a Statement object to store a query</li>
					<li>Executing the Statement object to receive a ResultSet</li>
					<li>Processing the ResultSet</li>
					<li>Closing resources: ResultSet, Statement, and connection</li>
				</ol>
			</div>
			
			<div class="col-3">
				<img src="images/jdbc-overview-diagram.gif" alt="JDBC Overview Diagram"/>
			</div>
		</div>
		
		<hr><!------------------------------------------------------------------------------------------>
	
		<h4>Step 1: Importing JDBC Packages</h4> <br>
		
		<p>Before we can begin loading/registering JDBC drivers, establishing a connection, and creating the various 
		objects needed to work with our database, we must first import the necessary packages.</p>
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Gives access to classes such as: DriverManager and SQLException<br>
			*<br>
			*  Gives access to interfaces such as: Connection, Statement,<br>
			*  PreparedStatement, CallableStatement, ResultSet, etc.<br>
			*/</span><br>
			import java.sql.*;<br><br>
			
			
			<span style="color: #0da003;">
			// Gives access to OracleDriver <br>
			</span>
			import oracle.jdbc.driver.*;<br><br>
			
			<span style="color: #0da003;">
			// Gives access to Oracle-specific classes: BLOB, CLOB, BFILE, etc.<br>
			</span>
			import oracle.sql.*;
		</div>
		<br> 
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 2: Loading and registering the appropriate JDBC driver</h4> <br>
		
		<div class="row">
			<div class="col-5">
				<p>Once we have the proper packages imported, we then need to establish a communication between our database
				and the JDBC. Since there are multiple database providers, each have their own respective driver which will
				need to be loaded. For this example, we will be working with an Oracle database - and therefore, will load
				and register the Oracle driver. The diagram to the right shows a hierarchy for the JDBC Driver and the various
				database manufacturers' drivers.</p>
			</div>
			
			<div class="col-4">
				<img src="images/jdbc-driver-diagram.png" alt="JDBC Driver diagram" width="450" height="225"/>
			</div>
		</div>
		
		<p>As with most things in Java, there is more than one way to accomplish the task of loading and registering the
		necessary driver. The first way is by utilizing the <span style="font-family: Courier">Class.forName()</span> method of the 
		<span style="font-family: Courier">java.lang</span> package to load the JDBC drivers directly.</p>
		
		<div class="code">
			<span style="color: #0da003;">
			// Passing in the complete package name of the OracleDriver class<br>
			</span>
			Class.forName("oracle.jdbc.driver.OracleDriver");
		</div><br>
		
		<p>Still using the <span style="font-family: Courier">Class.forName()</span> method, we can also pass in a driver by using
		a Properties object (found in the <span style="font-family: Courier">java.util package</span>) - assuming that we have 
		created an <span style="font-family: Courier">application.properties</span> file, and it has been configured with a driver 
		property correctly.</p><br>
		
		<span style="margin-left: 100px">application.properties</span>
		<div class="code">
			driver=oracle.jdbc.driver.OracleDriver<br>
		</div><br>
		
		<span style="margin-left: 100px">SomeClass.java</span>
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Creating a Properties object and loading it with the data found in<br>
			*  application.properties<br>
			*<br>
			*  NOTE: various exceptions will need to be handled; handling omitted<br>
			*  here for brevity<br>
			*/</span><br>
			Properties prop = new Properties();<br><br>
			prop.load(new FileReader("C:/Users/exampleUser/my_workspace/myProject" +<br>
			&nbsp;&nbsp;&nbsp;&nbsp;"/src/main/resources/application.properties"));<br><br>
			
			
			<span style="color: #0da003;">
			/*<br>
			*  Passing the Properties object into Class.forName() and getting the<br>
			*  "driver" attribute. The value of this attribute is the same as the<br>
			*  full package name of the OracleDriver class that we used in the<br>
			*  first example.<br>
			*/</span><br>
			Class.forName(prop.getProperty("driver"));
		</div><br>
	
		<p>The alternative to using the <span style="font-family: Courier">Class.forName()</span> is to use the 
		<span style="font-family: Courier">DriverManager.registerDriver()</span> method, which we imported with
		<span style="font-family: Courier">java.sql</span> package.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Creating a new instance of the OracleClass by calling its constructor,<br>
			*  and passing it into the DriverManager.registerDriver() method.<br>
			*/<br>
			</span>
			DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());
			
		</div><br>
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 3: Establish a connection to the database</h4> <br>
		
		<p>Finally, now that we have done all of the "prep" work, we can connect to our database. The packages we 
		imported in Step 1 can be put to use. Inside of the <span style="font-family: Courier">java.sql</span> 
		package, we are provided with the Connection interface and the DriverManager class.</p>
		
		<p>The DriverManager class has a private constructor, which means that the class itself cannot be directly 
		instantiated into an object. Because of this, it is equipped with static methods for managing and getting 
		connections. The key method we will focus at this point is the <span style="font-family: Courier">.getConnection()</span>
		method, which as it names suggests is what we will use to establish a connection to our database. The
		<span style="font-family: Courier">.getConnection()</span> method takes in three parameters: the URL at
		which the database server can be found, and a username/password combination that has access to the database.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Declare a Connection variable (it is an interface so it cannot<br>
			*  be instantiated itself, so for now we set it to null)<br>
			*/<br></span>
			Connection conn = null;<br><br>
			
		
			try {<br>
			
			<span style="color: #0da003;">
			&nbsp;&nbsp;/*<br>
			&nbsp;&nbsp;*  This should look familiar, its the same code we used in Step 2<br>
			&nbsp;&nbsp;*  to load and register our Oracle driver. Throws ClassNotFoundException.<br>
			&nbsp;&nbsp;*/<br></span>
			&nbsp;&nbsp;Class.forName(prop.getProperty("driver"));<br><br>
			
			<span style="color: #0da003;">
			&nbsp;&nbsp;/*<br>
			&nbsp;&nbsp;*  Here we are using DriverManager's static .getConnection()<br>
			&nbsp;&nbsp;*  and passing the URL of our database (this is an example of<br>
			&nbsp;&nbsp;*  a locally hosted database). Additionally, we are passing in<br>
			&nbsp;&nbsp;*  the username/password combination to access a database schema.<br>
			&nbsp;&nbsp;*  Throws SQLException.<br>
			
			&nbsp;&nbsp;*/<br></span>
			&nbsp;&nbsp;conn = DriverManager.getConnection(<br>
			&nbsp;&nbsp;&nbsp;&nbsp;"jdbc:oracle:thin:@//localhost:1521/XE",<br>
			&nbsp;&nbsp;&nbsp;&nbsp;"username",<br>
			&nbsp;&nbsp;&nbsp;&nbsp;"password");<br>
			
			}<br><br>
		
			catch (ClassNotFoundException cnfe) {<br>
			&nbsp;&nbsp;cnfe.printStackTrace();<br>
			} <br><br>
			
			catch (SQLException sqle) {<br>
			&nbsp;&nbsp;sqle.printStackTrace();<br>
			}<br>
			
			
		</div><br>
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 4: Creating a Statement object to store a query</h4> <br>
		
		<p>With the connection to the database established, our Java application is now prepared to interact
		our Oracle database. To prepare a Statement to be sent to our database we use the, again aptly named,
		.prepareStatement() method provided by Connection.</p>
		
		<p>There are three types of statements that are provided by Connection: Statement, PreparedStatement,
		and CallableStatement. Statement is only to be used when we are executing query in which we do not
		need any user input. The reasoning behind restricting our usage of Statement is due to its vulnerability
		to SQL injection - SQL statements given as input from malicious end users for the purpose of either
		destroying data or exposing sensitive data. To avoid this, we use PreparedStatement	anytime we require
		the end user to provide input to construct a query. CallableStatement is used we will be accessing stored
		procedures with are held within our database.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			// A String object that will store the SQL statement<br>
			</span>
			String sql = "SELECT * FROM users";<br><br>
			
			<span style="color: #0da003;">
			/*<br>
			*  Creating a statement using the .createStatement() method provided by<br>
			*  Connection<br>
			*/<br>
			</span>
			Statement stmt = conn.createStatement();
		</div><br>
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 5: Executing the Statement object to receive a ResultSet</h4> <br>
		
		<p>Once a Statement object has been created it needs to be executed in order to receive a result
		set. To execute the Statement, we use the .executeQuery() method - which takes a String as an
		argument. In Step 4, we already prepared a String containing our SQL query that will be executed
		on the database. We will store the returned result set in a ResultSet object.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Our Statement object provides us the .executeQuery() method which<br>
			*  returns a ResultSet that we will store in a variable.<br>
			*/<br>
			</span>
			ResultSet rs = stmt.executeQuery(sql);<br>
		</div><br>
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 6: Processing the ResultSet</h4> <br>
		
		<p>We have executed our SQL statement in the database, and have received the results of our query
		and have them stored inside of a ResultSet object. Now we need actually get information from it so
		that it can be used in our application. To do this we make use of a while loop that will help us
		traverse through our ResultSet until we reach the end of it. We will persist the data retrieved
		from the database in some variables or objects that will be used elsewhere in our program.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Create an ArrayList to store our User objects that we will get<br>
			*  back once the ResultSet has been processed.<br>
			*/<br>
			</span>
			ArrayList<User> users = new ArrayList<User>();<br><br>
			
			
			<span style="color: #0da003;">
			/*<br>
			*  Using a while loop, that will execute so long as our ResultSet<br>
			*  'rs' has a next result, we can traverse through our result set<br>
			*  and persist the data into a User object that we add to our<br>
			*  ArrayList.<br>
			*/<br>
			</span>
			while(rs.next()) {<br><br>
				
			&nbsp;&nbsp;User temp = new User();<br>
			&nbsp;&nbsp;temp.setId(rs.getInt(1));<br>
			&nbsp;&nbsp;temp.setFirstName(rs.getString(2));<br>
			&nbsp;&nbsp;temp.setLastName(rs.getString(3));<br>
			&nbsp;&nbsp;temp.setEmailAddress(rs.getString(4));<br>
			&nbsp;&nbsp;temp.setUsername(rs.getString(5));<br>
			&nbsp;&nbsp;temp.setPassword(rs.getString(6));<br>
			&nbsp;&nbsp;users.add(temp);<br><br>
				
			}<br>
		</div><br>
		
		<hr><!------------------------------------------------------------------------------------------>
		
		<h4>Step 7: Closing the connection</h4> <br>
		
		<p>When finished with our ResultSet, it is important to close all of our resources to ensure that 
		we avoid memory management. Although, you are likely to see only the connection to our database 
		closed, it is considered best practice to close the ResultSet and Statement as well. When doing 
		so, take care to close them in reverse order from the manner which we created 
		them.</p><br>
	
		<div class="code">
			<span style="color: #0da003;">
			/*<br>
			*  Best practice requires that we close our all of our resources<br>
			*  to ensure we avoid memory leaks. Be sure to close them in order!<br>
			*/<br>
			</span>
			try { rs.close; } catch (Exception e) {}<br>
			try { stmt.close; } catch (Exception e) {}<br>
			try { conn.close; } catch (Exception e) {}<br>
			
		</div><br>
		
	</div>
</body>
</html>